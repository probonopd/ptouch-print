# devd rules to set permissive device node permissions for Brother P-Touch USB printers
# Install to /usr/local/etc/devd/ptouch.conf (package installs to /usr/local/etc/devd/)

# When a USB device with vendor 0x04f9 (Brother) is attached, set the created device
# node to be group-owned by operator and writable by everyone (0666).
# This single attach block matches all supported product IDs using a regex and
# applies permissions only to the created device node (via $cdev) or the
# device-name (/dev/$device-name) when available.

attach 10 {
	match "system" "USB";
	match "type" "ATTACH";
	match "vendor" "0x04f9";
	match "product" "(0x2004|0x2007|0x2011|0x2019|0x201f|0x202c|0x202d|0x2041|0x205e|0x205f|0x2061|0x2062|0x2073|0x2074|0x20af|0x20df|0x20e0|0x20e1|0x2201)";
	action "sh -c 'if [ -n "$cdev" ]; then /bin/chown root:operator \"$cdev\" && /bin/chmod 0666 \"$cdev\"; elif [ -n "$device-name" ]; then /bin/chown root:operator \"/dev/$device-name\" && /bin/chmod 0660 \"/dev/$device-name\"; fi'";
}
